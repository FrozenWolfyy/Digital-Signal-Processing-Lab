<h1>Digital Signal Processing </h1>
</br>
<h3>Lab 1 (b)</h3>
</br>

**AIM**

To implement and understand the following FIR(Finite-Impulse Response) Filters :
1. Moving Average Filter
2. Derivative Filter (First Order Difference)
3. Derivative Filter (Three Point Central Difference)

The following signals were used:
1. Real-time data from a PPG sensor.
2. Two ECG signals.

---

PPG (Photoplethysmogram) Sensor
---
A photoplethysmogram (PPG) is an optically obtained plethysmogram that can be used to detect blood volume changes in the microvascular bed of tissue.
<p float="left" align = "center">
  <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/PPG%20Sensorpng" width=400/>
</p>

The working principle of the PPG sensor is based on the emission of infrared light by an LED which penetrates the skin and blood vessels. This light is captured by the detector to measure the blood stream. The results of the PPG signal depend primarily on the flow of blood and oxygen to the capillary vessels in each heartbeat.

The advantages that a PPG sensor has over an ECG machine is that it is small and portable, wheras the disadvantage is that it is not as precise as an ECG machine. 

<p float="left" align = "center">
  <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/PPG_Sensor_2.jpeg" width=400/>
</p>

To connect the PPG sensor to the Arduino board, connect the pins to one of the analog pin on the board and to the 5V output pin and to the ground pin on the board.

---
Moving Average Filter
---
The mathematical expression for a moving average filter in the time domain and Z domain are:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Equations/MVA eqn.png" width=400/>
</p>

The Transfer function can also be found from the above equations :
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Equations/MVA eqn.png" width=400/>
</p>

The Pole Zero Plot of the MVA filter is given by:
<p float="left" align = "center">
<img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Poles%26zeros%20of%20mva.png" width=600/>
</p>

Magnitude and Phase Responses can be obtained as follows:
<p float="left" align = "center">
<img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Mag%26phase%20of%20mva.png" width=800/>
</p>

From the Magnitude v/s Frequency plot of the MVA Filter we can say that its a Low pass Filter.

---
First Order Derivative
---
The mathematical expression for a First Order Derivative Filter in the time domain and Z domain are:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Equations/Three%20point%20diff%20eqn.png" width=400/>
</p>

Poles and Zeroes are given by:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Poles%20and%20zeros%20of%201st%20order%20diff.png" width=600/>
</p>

Magnitude and Phase Responses of a First Order Derivative function is given by:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Equations/First%20Order.png" width=400/>
</p>
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Mag%26phase%20of%20first%20order%20difference.png" width=800/>
</p>

From the Magnitude Response of the First Order Derivative Filter we can conlcude that its a High pass Filter.

---
Three Point Central Difference
---
The mathematical expression for a First Order Derivative Filter in the time domain and Z domain are:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Equations/First%20Order%20diff%20eqn.png" width=400/>
</p>

Poles and Zeroes are given by:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/poles%20and%20zeros%20of%20threepoint%20diff.png width=600/>
</p>

Magnitude and Phase Responses of a Three point Central Difference Filter is given by:
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Equations/Three%20Point.png" width=400/>
</p>
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab 1 (b)/Pictures/Mag%20and%20phase%20of%20three%20point%20diff.png" width=800/>
</p>

From the Magnitude Response of the First Order Derivative Filter we can conlcude that its a Band-Pass pass Filter.

**Arduino Code for Real Time data**
```cpp
float x[500];
float y[500];
int count =0;
float z[500];
void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  Serial.println("Original_data MVA_data 1st_order 3_point");

}

void loop() {
  // put your main code here, to run repeatedly:
int i = 0;
while(i<500){
  x[i] = analogRead(A0);
  delay(10);
  i++;
}


int l=8;
for(int i=0;i<500;i++)
{
  double sum=0;                    // initialize a variable to store the sum value.
  count=0;
  for(int k=0;k<l;k++)
  {
   sum=sum+x[i-k];                   // sum of the past l values.
   
   if(x[i-k]!=0)                     // finding number of non zero values.
   {
    count++;
    }
  }
y[i]=sum/count;                   // averaging them.
z[i]=y[i]-y[i-1];
}


for(int i=0;i<500;i++)
{  
Serial.print(x[i]+1000);
Serial.print(',');
Serial.print(y[i]+500);
Serial.print(','); 
Serial.print(z[i]+250);
Serial.print(','); 
Serial.println(y[i]-y[i-2]);
}
}


```

**Plot from arduino code**
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Arduino%20Plots/Data%20from%20PPG%20sensor.png" width=800/>
</p>

<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Derivative.png" width=800/>
</p>


**Arduino Code for ECG data**
```cpp
float x[1000]={-56.052,-65.16,-70.057,-77.831,-80.454,-80.161,-80.522,-80.141,-78.493,-92.218,-119.65,-41.335,179.14,366.18,182.76,-94.843,-71.877,-63.995,-73.893,-81.827,-87.317,-88.533,-91.093,-91.607,-88.449,-88.978,-87.279,-86.867,-83.809,-79.978,-75.734,-68.949,-61.979,-53.672,-41.941,-29.806,-18.232,-3.7264,5.5248,14.187,19.703,20.566,13.537,0.10333,-14.502,-30.764,-45.391,-54.576,-60.271,-62.11,-63.315,-64.787,-63.9,-61.643,-60.74,-58.92,-58.075,-58.21,-55.908,-55.136,-55.606,-58.182,-60.001,-56.596,-58.071,-62.834,-63.38,-66.145,-67.524,-69.507,-71.865,-71.223,-73.275,-74.797,-74.85,-75.988,-73.426,-68.051,-62.611,-58.782,-54.316,-52.325,-54.14,-63.517,-61.144,-65.791,-74.253,-79.894,-83.881,-86.552,-86.133,-87.062,-85.239,-86.482,-88.308,-109.61,-95.561,65.693,284.7,279.59,3.1473,-112.6,-71.293,-78.672,-81.67,-87.948,-92.125,-93.076,-94.35,-96.457,-95.057,-93.097,-93.241,-91.817,-89.486,-86.689,-83.713,-76.604,-71.117,-62.771,-52.215,-39.937,-28.233,-16.496,-6.279,2.6256,8.5822,8.7426,6.2281,-3.2118,-16.407,-30.88,-43.342,-50.34,-56.783,-59.581,-61.309,-63.653,-64.986,-63.212,-62.534,-59.654,-58.72,-57.734,-56.494,-54.596,-52.412,-52.282,-53.921,-54.328,-53.963,-56.683,-59.568,-61.89,-61.426,-65.412,-67.558,-70.067,-71.683,-72.237,-73.783,-73.789,-75.575,-76.136,-76.585,-78.378,-76.653,-68.174,-62.876,-61.011,-57.001,-55.066,-54.004,-61.762,-64.562,-64.325,-72.934,-79.747,-85.552,-89.098,-90.668,-92.681,-91.477,-91.006,-90.068,-95.836,-122.28,-111.38,22.021,265.67,335.61,40.794,-117.82,-73.203,-76.727,-83.389,-90.79,-96.347,-97.993,-100.06,-100.06,-100.32,-99.236,-98.23,-96.553,-94.43,-92.791,-89.037,-84.578,-79.241,-71.819,-61.426,-52.076,-39.969,-28.079,-16.836,-5.2877,3.4562,7.8468,9.8371,6.6328,-4.8066,-18.855,-35.406,-48.948,-57.899,-65.185,-69.52,-71.94,-72.346,-71.474,-70.65,-70.319,-69.527,-66.479,-66.935,-63.913,-64.568,-63.496,-63.098,-65.004,-66.114,-68.934,-69.401,-71.302,-74.373,-76.565,-80.137,-80.968,-82.414,-83.626,-84.244,-82.516,-84.068,-82.637,-84.691,-84.155,-82.095,-76.083,-69.807,-67.111,-61.484,-59.134,-60.278,-69.045,-71.064,-70.192,-80.117,-85.394,-91.546,-94.693,-95.562,-95.606,-96.123,-96.126,-95.999,-97.807,-122.6,-112.72,44.245,295.36,307.66,-14.615,-121.04,-78.702,-87.793,-92.604,-99.146,-103.26,-105.25,-105.62,-105.71,-106.03,-104.56,-103.94,-100.66,-99.189,-92.821,-89.904,-82.27,-73.27,-61.636,-48.597,-36.178,-24.492,-14.938,-4.9008,2.3127,4.7297,0.76965,-9.6305,-25.807,-42.847,-56.879,-66.482,-71.348,-75.668,-76.688,-76.622,-77.146,-75.341,-73.666,-70.869,-69.031,-67.884,-66.077,-65.479,-66.351,-67.863,-68.641,-72.348,-73.583,-76.907,-80.488,-79.549,-80.793,-82.034,-83.837,-85.299,-86.019,-86.081,-86.162,-86.689,-86.421,-85.274,-86.86,-85.163,-85.28,-81.717,-73.771,-68.503,-64.059,-60.965,-60.467,-67.417,-70.782,-66.955,-76.005,-80.639,-86.125,-89.6,-90.08,-90.576,-90.473,-90.415,-90.232,-89.72,-85.926,-91.624,-116.58,-53.213,189,368.88,79.825,-116.55,-63.889,-76.088,-77.243,-89.591,-87.631,-89.087,-88.193,-87.046,-85.521,-83.429,-80.306,-76.858,-72.534,-65.723,-58.646,-48.432,-36.165,-23.102,-8.4958,4.2907,14.538,22.37,27.378,25.95,18.821,8.1749,-8.4959,-23.681,-34.2,-41.106,-46.805,-48.237,-48.188,-46.091,-45.473,-45.147,-41.623,-40.867,-38.02,-36.531,-36.016,-35.401,-36.269,-35.14,-36.397,-38.662,-40.858,-42.165,-44.796,-46.62,-47.29,-48.97,-51.82,-51.567,-53.114,-54.113,-54.734,-54.309,-55.02,-54.7,-54.399,-51.495,-41.485,-37.148,-33.529,-30.309,-29.584,-38.385,-39.237,-39.467,-49.124,-55.441,-60.843,-62.208,-62.431,-62.705,-65.16,-64.358,-61.839,-61.197,-59,-70.702,-93.029,3.5899,269.18,363.18,34.068,-86.279,-35.808,-52.749,-54.041,-64.176,-62.395,-65.852,-65.624,-67.023,-64.325,-62.864,-60.292,-58.568,-54.461,-49.84,-42.534,-33.917,-22.48,-11.024,1.7858,11.705,19.282,28.309,31.897,32.441,24.259,12.562,-2.0932,-18.917,-31.15,-37.924,-44.693,-47.679,-47.927,-50.35,-49.651,-49.728,-48.954,-44.996,-45.004,-45.274,-44.062,-43.944,-43.842,-43.146,-45.773,-45.769,-47.721,-50.346,-50.302,-54.181,-57.324,-60.96,-61.241,-64.744,-64.933,-65.663,-68.5,-70.011,-69.482,-69.952,-71.345,-72.981,-73.66,-71.247,-65.009,-57.573,-55.32,-53.467,-52.855,-63.128,-63.859,-63.084,-72.638,-76.707,-82.211,-85.945,-86.728,-86.622,-88.511,-90.287,-90.347,-87.52,-86.895,-96.863,-120.33,-53.429,153.34,336.94,158.82,-103.46,-94.38,-76.3,-81.435,-91.407,-95.074,-95.763,-97.617,-96.344,-97.476,-95.608,-95.501,-93.853,-92.731,-88.858,-85.978,-80.522,-74.601,-67.977,-56.963,-45.752,-35.306,-25.791,-16.995,-8.786,-4.3223,-1.9508,-5.7932,-13.769,-26.081,-41.597,-53.993,-62.731,-69.664,-73.554,-77.643,-78.109,-79.233,-79.13,-78.653,-77.273,-75.09,-74.737,-72.734,-71.681,-70.994,-70.735,-72.224,-72.513,-74.05,-76.316,-78.996,-81.739,-84.178,-87.081,-87.966,-88.86,-91.322,-93.065,-93.9,-95.044,-95.68,-95.904,-94.974,-87.464,-81.111,-77.538,-77.428,-76.789,-81.281,-88.864,-83.561,-93.693,-101.02,-107.84,-112.46,-111.36,-112.64,-112.21,-111.73,-111.52,-124.8,-141.36,-36.032,220.09,314.57,16.632,-141.64,-94.187,-102.99,-108.2,-116.59,-121.52,-122.93,-121.89,-121.87,-121.56,-119.92,-119.25,-118.04,-113.98,-110.98,-107.42,-101.99,-95.109,-85.323,-72.094,-60.53,-46.378,-34.502,-25.335,-18.433,-12.294,-11.545,-16.135,-25.653,-39.76,-56.278,-72.613,-82.316,-90.729,-94.155,-97.243,-99.223,-98.004,-98.651,-96.611,-97.354,-95.465,-92.359,-89.678,-88.129,-87.571,-87.65,-87.76,-89.225,-91.184,-91.175,-94.281,-96.567,-98.656,-101.53,-101.57,-103.01,-103.74,-104.82,-107.55,-108.43,-108.86,-108.82,-109.63,-111.28,-108.64,-106.93,-98.059,-92.858,-90.055,-87.549,-85.137,-90.436,-96.646,-94.011,-102.67,-108.54,-116.26,-120.39,-120.64,-121.69,-123.24,-120.96,-116.91,-127.96,-150.19,-72.782,174.47,337.42,62.544,-146.31,-107.54,-105.69,-110.36,-117.81,-121.28,-122.46,-123.66,-123.17,-124.73,-124,-122.96,-119.85,-117.55,-115.65,-110.98,-105.68,-98.866,-88.165,-79.555,-66.461,-53.261,-39.663,-30.681,-22.294,-15.311,-11.026,-12.414,-20.493,-31.248,-47.567,-64.665,-76.432,-85.699,-90.716,-93.802,-95.897,-95.121,-95.348,-94.2,-94.268,-91.903,-90.251,-88.419,-89.017,-88.246,-85.321,-84.965,-86.966,-85.534,-87.346,-90.053,-91.801,-93.499,-94.016,-96.116,-96.942,-100.3,-101.06,-99.783,-102.27,-102.78,-103.97,-101.51,-102.78,-102.49,-100.43,-99.704,-95.4,-89.481,-84.477,-80.338,-77.291,-78.136,-80.057,-86.728,-82.069,-83.804,-94.057,-100.89,-103.33,-107.51,-107.62,-107.04,-107.4,-106.53,-104.33,-113.63,-132.29,-94.178,79.635,300.78,265.96,-41.968,-125.49,-84.553,-93.205,-97.778,-103.69,-107.13,-108.51,-109.9,-110.4,-108.53,-106.82,-106.14,-102.8,-100.68,-98.731,-93.691,-87.343,-80.089,-71.581,-59.37,-46.262,-34.6,-21.669,-12.186,-2.5141,4.0124,4.6568,1.8999,-5.624,-16.48,-32.572,-45.304,-57.443,-64.407,-69.03,-71.428,-73.168,-73.918,-73.381,-71.694,-69.14,-67.362,-65.212,-62.719,-63.496,-61.038,-60.995,-61.232,-61.188,-61.965,-63.162,-65.132,-68.235,-69.144,-72.093,-75.536,-76.084,-79.314,-80.595,-79.476,-80.014,-79.124,-79.81,-79.078,-77.468,-72.971,-67.017,-63.193,-57.893,-57.171,-58.783,-68.108,-64.137,-67.542,-77.529,-83.39,-86.998,-88.723,-89.927,-88.471,-88.024,-87.815,-97.6,-124.93,-67.559,149.72,375.85,207.4,-95.676,-85.29,-70.677,-79.394,-87.085,-93.475,-94.637,-96.326,-96.032,-96.204,-95.179,-92.293,-91.07,-87.294,-83.023,-79.318,-72.513,-64.442,-53.854,-41.625,-27.251,-14.724,-2.4985,8.3981,17.843,23.298,24.239,19.096,5.2046,-10.969,-30.787,-43.066,-53.921,-58.504,-60.842,-62.074,-61.461,-60.889,-61.771,-60.978,-57.734,-55.752,-54.655,-53.357,-53.139,-53.979,-55.442,-54.007,-57.935,-59.954,-61.412,-63.799,-66.396,-70.723,-69.991,-71.164,-73.192,-73.085,-73.717,-73.596,-72.714,-73.351,-72.818,-64.29,-58.289,-53.543,-50.177,-48.72,-55.711,-60.715,-56.287,-68.61,-74.568,-79.27,-82.415,-83.745,-85.047,-83.122,-83.029,-86.247,-115.07,-59.766,161.66,378.16,164.09,-107.81,-72.074,-63.218,-79.989
  };
float y[1000];
float y2[1000];
float z[1000];

int i=0;
int l;
int count =0;
void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  Serial.println("Original_data MVA_length_2 MVA_length_8 First_order Three_point");



l=2;
for(int i=0;i<1000;i++)
{
  double sum=0;                    // initialize a variable to store the sum value.
  count=0;
  for(int k=0;k<l;k++)
  {
   sum=sum+x[i-k];                   // sum of the past l values.
   
   if(x[i-k]!=0)                     // finding number of non zero values.
   {
    count++;
    }
  }
y[i]=sum/count;                   // averaging them.
}

l=8;
for(int i=0;i<1000;i++)
{
  double sum=0;                    // initialize a variable to store the sum value.
  count=0;
  for(int k=0;k<l;k++)
  {
   sum=sum+x[i-k];                   // sum of the past l values.
   
   if(x[i-k]!=0)                     // finding number of non zero values.
   {
    count++;
    }
  }
y2[i]=sum/count;                   // averaging them.
}

}

void loop() 
{
  // put your main code here, to run repeatedly:


for(int i=0;i<1000;i++)
{  
Serial.print(x[i]+1000);
Serial.print(',');
Serial.print(y[i]+750);
Serial.print(','); 
Serial.print(y2[i]+500);
Serial.print(',');
Serial.print(y[i]-y[i-1]+250);
Serial.print(','); 
Serial.println(y[i]-y[i-2]+125);
}
}
```
**Plots**
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Arduino%20Plots/ECG_sig1%20Filters.png" width=800/>
</p>

<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Arduino%20Plots/ECG_sig2%20Filters.png" width=800/>
</p>

---
Baseline Removal
---
**Arduino Code for Real Time data**
```cpp
float x[500];
float y[500];
int count =0;
void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  Serial.println("Origina_data Baseline Smoothened");

}

void loop() {
  // put your main code here, to run repeatedly:
int i = 0;
while(i<500){
  x[i] = analogRead(A0);
  delay(10);
  i++;
}


int l=400;
for(int i=0;i<500;i++)
{
  double sum=0;                    // initialize a variable to store the sum value.
  count=0;
  for(int k=0;k<l;k++)
  {
   sum=sum+x[i-k];                   // sum of the past l values.
   
   if(x[i-k]!=0)                     // finding number of non zero values.
   {
    count++;
    }
  }
y[i]=sum/count;                   // averaging them.
}


for(int i=0;i<500;i++)
{  
Serial.print(x[i]);
Serial.print(',');
Serial.print(y[i]);
Serial.print(','); 
Serial.println(x[i]-y[i]);
}
}
```
**Plot**
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Arduino%20Plots/Baseline%20Removal%20PPG%20sensor.png" width=800/>
</p>

**Arduino Code for ECG signal**
```cpp
float x[1000]={-190.27,-197.84,-118.82,94.155,242.95,110.82,-187.3,-174.45,-139.95,-184.74,-187.83,-188.25,-187.86,-191.96,-191,-189.95,-196.75,-198.88,-190.11,-189.76,-193.68,-186.1,-180.39,-183.38,-177.91,-168.1,-165.77,-158.71,-145.97,-134.17,-124.33,-108.08,-93.813,-86.876,-75.059,-65.417,-75.636,-93.986,-110.35,-134.22,-156.9,-166.17,-171.94,-182.03,-181.46,-180.98,-185.9,-187.51,-178.5,-177.78,-178.71,-173.25,-174.38,-179.02,-174.92,-172.38,-175.5,-177.03,-174.03,-176.11,-183.06,-176.66,-178.56,-183.8,-180.5,-177.29,-181.97,-185.99,-182.67,-184.28,-190.92,-184.42,-174.32,-165.53,-154.13,-126.84,-121.41,-129.44,-128.04,-161.12,-191.3,-190.2,-191.62,-199.45,-199,-193.13,-196.88,-198.82,-194.5,-202.49,-171.79,8.3832,208,206.62,-78.992,-215.86,-137.22,-178.61,-186.05,-189.77,-194.28,-195.24,-190.54,-198.79,-199.31,-192.14,-192.21,-194.38,-188.38,-186.88,-186.96,-180.18,-174.02,-174.32,-166.4,-152.48,-145.46,-135.68,-117.89,-106.14,-97.202,-85.065,-72.636,-72.989,-74.596,-83.994,-110.96,-132.64,-145.74,-159.66,-172.39,-175.05,-177.9,-184.57,-183.04,-179.16,-181.96,-184.56,-171.33,-170.2,-174.12,-158.42,-88.047,29.852,182.87,333.12,391.43,381.71,330,323.14,303.57,213.1,3.8401,-207.25,-211.87,-232.52,-258.36,-269.92,-272.06,-281.35,-296.81,-300.18,-305.47,-315.72,-321.63,-320.64,-327.4,-327.21,-340.3,-366.72,-402.4,-439.59,-456.3,-460.43,-450.61,-428.77,-400.74,-363.59,-315.97,-281.15,-256.2,-237.44,-227.78,-229.77,-227.89,-220.3,-221.12,-221.91,-217.28,-215.5,-218.57,-213.19,-209.5,-213.77,-211.58,-207.67,-209.99,-209.42,-205.99,-203.4,-206.63,-202.36,-198.53,-203.72,-203.41,-198.31,-201.7,-201.37,-195.23,-197.06,-200.47,-194.1,-190.88,-196.84,-196.16,-188.35,-193.87,-196.07,-188.06,-188.89,-192.13,-188.54,-184.7,-191.63,-190.52,-185.36,-189.84,-188.54,-183.53,-184.65,-188.28,-185.53,-183.39,-187.88,-185.67,-181.8,-184.05,-184.37,-179.59,-181.8,-186.5,-182.32,-179.88,-183.91,-184.74,-177.3,-180.3,-184.33,-179.62,-179.87,-182.45,-179.69,-179.16,-182.39,-180.55,-175.68,-177.54,-182.78,-173.9,-164.61,-157.52,-147.25,-120.52,-111.79,-116.24,-115.25,-153.72,-184.56,-181.01,-182.56,-190.83,-186.7,-183.94,-191.92,-195.71,-61.47,176.79,216.45,-76.675,-200.23,-137.04,-180.05,-182.65,-189.47,-189.01,-192.61,-198.18,-196.62,-190.75,-191.93,-199.47,-193.7,-188.87,-190.17,-188.89,-181.91,-178.22,-181.98,-172.45,-164.14,-161.94,-149.49,-135.23,-129.01,-120.12,-104.35,-99.21,-95.017,-84.075,-78.971,-91.516,-101.91,-119.14,-138.23,-147.96,-150.16,-157.75,-162.01,-161.05,-159.79,-161.86,-159.02,-154.6,-154.79,-154.93,-152.59,-131.92,-50.6,75.08,229.53,350.11,406.73,393.88,332.53,327.04,274.1,136.18,-98.25,-211.12,-203.36,-242.76,-250.65,-257.6,-271.02,-277,-279.13,-290.26,-297.31,-292.9,-298.59,-301.54,-301.16,-318.44,-350,-393.24,-425.47,-444.59,-455.33,-451.8,-442.59,-432.07,-405.13,-371.02,-338.03,-299.93,-266.26,-247.29,-237.94,-230.89,-229.33,-231.44,-228.3,-224.99,-225.5,-223.67,-218.28,-218.59,-218.24,-213.01,-212.07,-218.16,-212.88,-210.54,-213.54,-211.69,-206.16,-207.68,-211.29,-204.16,-202.56,-207.33,-206.05,-198.46,-203.66,-202.15,-197.84,-199.11,-200.14,-197.94,-199.18,-202.25,-197.14,-192.41,-197.53,-196.25,-190.2,-191.32,-197.28,-189.64,-187.28,-192.02,-189.46,-184.82,-189.15,-188.12,-181.46,-184.82,-188.01,-181.81,-181.29,-188.48,-181.44,-177.74,-182.54,-184.35,-178.01,-179.45,-182.32,-176.85,-173.29,-177.55,-174.26,-170.95,-176.31,-174.12,-171.72,-173.65,-175.03,-166.11,-168.62,-176.02,-170.23,-165.42,-164.35,-149.5,-134.49,-122.49,-104.96,-103.69,-104.1,-124.45,-159.05,-166.69,-171.17,-172.75,-168.82,-170.23,-171.9,-170.73,-177.57,-102.4,128.14,264.24,112.29,-165.28,-143.57,-125.78,-174,-167.24,-170.5,-178.07,-177.84,-173.24,-180.44,-179.72,-177.44,-179.52,-184.38,-177.02,-173.95,-178.21,-171.84,-163.34,-165.35,-160.41,-147.01,-145.37,-139.01,-123.25,-107.62,-105.79,-94.688,-81.208,-76.614,-71.134,-60.199,-66.763,-80.147,-88.939,-103.79,-122.84,-131.1,-133.17,-146.71,-146.75,-143.33,-147.3,-148.82,-143.06,-142.3,-143.96,-146.17,-144.68,-148.82,-148.13,-145.5,-149.63,-155.61,-150.94,-154.37,-164.72,-161.46,-123.88,-42.94,56.094,188.09,300.39,353.72,376.17,364.07,349.68,312.48,215.92,2.5273,-184.1,-171.87,-188.45,-205.36,-190.31,-187.71,-205.6,-224.07,-269.73,-302.22,-314.46,-327.29,-341.86,-361.83,-377.36,-394.87,-419.55,-437.77,-447.53,-461.92,-467.37,-460.32,-448.11,-433.24,-399.34,-361.2,-328,-292.01,-260.53,-242.79,-234.83,-225.96,-222.57,-227.91,-223.49,-220.79,-223.76,-219.06,-218.27,-220.56,-219.02,-209.26,-208.32,-211.3,-205.09,-201.9,-206.53,-204.14,-199.69,-202.09,-203.08,-196.96,-197.78,-203.44,-193.06,-191.95,-197.84,-196.78,-192.88,-196.65,-197.8,-191.72,-192.55,-198.31,-193.68,-188.73,-194.76,-193.07,-187.86,-190.3,-189.49,-183.44,-185.35,-189.47,-187.09,-184.53,-185.17,-183.77,-182.99,-185.29,-186.47,-181.09,-180.65,-185.94,-179.55,-178.3,-182.46,-180.26,-177.59,-180.35,-182.55,-178.68,-177.4,-182.86,-177.91,-176.89,-182.02,-178.51,-173.65,-174.52,-176.65,-163.52,-151.26,-146.95,-122.46,-102.3,-111.98,-115.8,-142.47,-176.4,-178.95,-172.81,-174.34,-181.95,-178.86,-183.33,-182.8,-21.193,218.83,205.98,-106.33,-180.98,-123.26,-174.44,-175,-177.01,-182.52,-183.18,-178.22,-185.82,-189.42,-182.34,-182.94,-187.56,-183.53,-180,-181.94,-178.65,-169.95,-167.78,-166.39,-152.31,-144.19,-138.43,-122.43,-110.28,-105.02,-96.308,-82.961,-77.642,-74.34,-70.531,-81.958,-99.359,-109.56,-122.76,-139.55,-147.44,-146.78,-155.46,-161.77,-154.81,-154.22,-159.08,-155.39,-148.66,-152.47,-154.82,-149.53,-151.86,-154.35,-151.08,-152.76,-158.26,-157.6,-158.88,-165.09,-167.49,-164.17,-169.99,-175.22,-170.17,-172.91,-176.69,-175.95,-173.91,-178.03,-178.26,-175.92,-176.23,-179.2,-175.37,-176.42,-176.47,-161.09,-146.56,-142.11,-117.19,-103.49,-112.81,-123.41,-154.21,-177.11,-183.47,-180.81,-181.75,-189.3,-187.8,-181.17,-184.13,-196.07,-154.33,32.775,220.83,159.19,-143.5,-187.43,-143,-183.74,-181.8,-189.46,-187,-187.27,-191.4,-192.74,-188.24,-193.8,-193.25,-185.85,-187.68,-189.9,-182.48,-178.68,-178.77,-171.43,-162.41,-156.88,-150.64,-133.78,-123.9,-115.38,-98.99,-93.005,-91.002,-84.148,-89.357,-109.07,-129.49,-147.32,-162.79,-177.54,-179.39,-184.48,-191.96,-190.99,-184.4,-190.88,-192.1,-183.06,-182.75,-185.34,-175.81,-175.94,-181.03,-177.52,-178.99,-184.76,-187.32,-184.28,-187.66,-193.24,-187.28,-188.29,-199.15,-193.66,-188.38,-193.22,-193.5,-190.09,-192.73,-195.8,-184.74,-172.23,-167.5,-149.08,-122.48,-132.17,-132.85,-138.55,-175.61,-197.8,-195.68,-196.75,-203.24,-200.89,-200.67,-201.88,-199.93,-202.72,-177.24,19.224,220.59,165.86,-143.39,-205.21,-143.67,-195.56,-195.29,-195.2,-201.99,-206.8,-202.85,-202.37,-204.28,-199.48,-197.24,-201.51,-198.1,-194.25,-196.34,-194.69,-183.62,-177.6,-176.41,-165.14,-153.04,-144.34,-136.05,-118.6,-106.22,-101.12,-85.011,-79.761,-83.598,-85.665,-98.288,-121.83,-141.72,-152.77,-171.25,-182.56,-180.61,-185.83,-190.66,-186.44,-180.98,-184.97,-181.11,-171.01,-173.35,-177.5,-152.41,-64.894,60.565,223.62,356.42,391.51,363.25,323.2,331.37,274.51,118.98,-138.55,-231.51,-224.98,-259.51,-273.34,-286.9,-286.53,-298.33,-309.55,-309.78,-312.2,-320.83,-322.98,-314.61,-335.5,-360.22,-393.79,-448.52,-478.63,-488.1,-487.18,-485.17,-464.61,-429.09,-391.29,-349.67,-303.18,-271.26,-260.73,-246.36,-244.25,-244.87,-240.31,-237.38,-238.23,-236.57,-233.54,-237.11,-236.64,-230.06,-227.27,-232.86,-229.69,-224.5,-228.94,-229.24,-222.26,-223.15,-224.73,-220.1,-219.9,-226.48,-221.53,-218.46,-222,-219.44,-214.98,-217.29,-219.22,-215.86,-215.08,-221.55,-217.32,-214.45,-221.44,-216.9,-212.96,-215.26,-220.49,-214.45,-211.73,-217.16,-215.01,-211.29,-216.24,-214.85,-209.11,-213.2,-215.46,-212.8,-211.02,-216.17,-214.86,-209.24,-211.88,-213.96,-212.15,-213.21,-214.35,-205.57,-205.51,-213.42,-208.81,-204.95,-209.43,-209.37,-205.82,-208.27,-208.05,-208.29,-200.36,-214.04,-197.4,-215.86
  };
float y[1000];
float y2[1000];
float z[1000];

int i=0;
int l;
int count =0;
void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  Serial.println("Original_data Baseline No_Noise_signal");

l=800;
for(int i=0;i<1000;i++)
{
  double sum=0;                    // initialize a variable to store the sum value.
  count=0;
  for(int k=0;k<l;k++)
  {
   sum=sum+x[i-k];                   // sum of the past l values.
   
   if(x[i-k]!=0)                     // finding number of non zero values.
   {
    count++;
    }
  }
y2[i]=sum/count;                   // averaging them.
}

}

void loop() 
{
  // put your main code here, to run repeatedly:


for(int i=0;i<1000;i++)
{  
Serial.print(x[i]+1000);
Serial.print(',');
Serial.print(y2[i]+1000);
Serial.print(',');
Serial.println(x[i]-y2[i]+1000);
Serial.print(',');
}
}
```
**Plots**
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Arduino%20Plots/Baseline_ECG_sig_1.png" width=800/>
</p>
<p float="left" align = "center">
 <img src="https://github.com/FrozenWolfyy/Digital-Signal-Processing-Lab/blob/master/Lab%201%20(b)/Pictures/Arduino%20Plots/Baseline_ECG_sig_2.png" width=800/>
</p>
